---
title: "fitting_binomial_data"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{fitting_binomial_data}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(WWdPCR)
```

# Example 1: simulated data

Simulate data from a 3PL logistic model, with lower asymptote at 0.2, and binomial distribution of the data:
```{r example1}
set.seed(43)

T <- 30
xx1 <- 0:T
yy1 <- pl3model(xx1, 0.5, -10, 0.2)
yy2 <- rbinom(T+1, 20, yy1) / 20
```

Fit a 3PL model with binomial noise:
```{r}
fit_3PL <- fit_pl(yy2, xx1, 20)
coef(fit_3PL)
```

Plot result:

```{r, fig.dim=c(6, 5)}
plot(xx1, yy2)
lines(xx1, yy1)
lines(xx1, fit_3PL$fitted, col="red")
legend("bottomright", legend=c("true", "3PL fit"),
       col=c("black", "red"),
       lty=c(1,1), cex=1)
```
